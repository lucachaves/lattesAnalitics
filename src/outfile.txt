[1] "BEGIN"
[1] "fff-country"
[1] "fff-country-rangeYear"
[1] "year 1973"
>>>> 10/07/2015 01:12:49
SELECT row_number() OVER () as id, oname, oy, ox, dname, dy, dx, count(*) trips FROM (SELECT countrySource.acronym oname, countrySource.latitude oy, countrySource.longitude ox, countryTarget.acronym dname, countryTarget.latitude dy, countryTarget.longitude dx FROM  public.edge edge , public.place instituitionSource, public.place citySource, public.place stateSource, public.place regionSource, public.place countrySource , public.place instituitionTarget, public.place cityTarget, public.place stateTarget, public.place regionTarget, public.place countryTarget WHERE edge.kind='doutorado' AND edge.end_year = 1973 AND edge.kind != 'work'  AND  edge.source = instituitionSource.id AND instituitionSource.kind ='instituition' AND instituitionSource.belong_to = citySource.id AND citySource.kind ='city' AND citySource.belong_to = stateSource.id AND stateSource.kind ='state' AND stateSource.belong_to = regionSource.id AND regionSource.kind ='region' AND regionSource.belong_to = countrySource.id AND countrySource.kind ='country'  AND  edge.target = instituitionTarget.id AND instituitionTarget.kind ='instituition' AND instituitionTarget.belong_to = cityTarget.id AND cityTarget.kind ='city' AND cityTarget.belong_to = stateTarget.id AND stateTarget.kind ='state' AND stateTarget.belong_to = regionTarget.id AND regionTarget.kind ='region' AND regionTarget.belong_to = countryTarget.id AND countryTarget.kind ='country' UNION ALL SELECT countrySource.acronym oname, countrySource.latitude oy, countrySource.longitude ox, countryTarget.acronym dname, countryTarget.latitude dy, countryTarget.longitude dx FROM  public.edge edge , public.place instituitionSource, public.place citySource, public.place stateSource, public.place regionSource, public.place countrySource , public.place instituitionTarget, public.place cityTarget, public.place countryTarget WHERE edge.kind='doutorado' AND edge.end_year = 1973 AND edge.kind != 'work'  AND  edge.source = instituitionSource.id AND instituitionSource.kind ='instituition' AND instituitionSource.belong_to = citySource.id AND citySource.kind ='city' AND citySource.belong_to = stateSource.id AND stateSource.kind ='state' AND stateSource.belong_to = regionSource.id AND regionSource.kind ='region' AND regionSource.belong_to = countrySource.id AND countrySource.kind ='country'  AND  edge.target = instituitionTarget.id AND instituitionTarget.kind ='instituition' AND instituitionTarget.belong_to = cityTarget.id AND cityTarget.kind ='city' AND cityTarget.belong_to = countryTarget.id AND countryTarget.kind ='country' UNION ALL SELECT countrySource.acronym oname, countrySource.latitude oy, countrySource.longitude ox, countryTarget.acronym dname, countryTarget.latitude dy, countryTarget.longitude dx FROM  public.edge edge , public.place instituitionSource, public.place citySource, public.place countrySource , public.place instituitionTarget, public.place cityTarget, public.place stateTarget, public.place regionTarget, public.place countryTarget WHERE edge.kind='doutorado' AND edge.end_year = 1973 AND edge.kind != 'work'  AND  edge.source = instituitionSource.id AND instituitionSource.kind ='instituition' AND instituitionSource.belong_to = citySource.id AND citySource.kind ='city' AND citySource.belong_to = countrySource.id AND countrySource.kind ='country'  AND  edge.target = instituitionTarget.id AND instituitionTarget.kind ='instituition' AND instituitionTarget.belong_to = cityTarget.id AND cityTarget.kind ='city' AND cityTarget.belong_to = stateTarget.id AND stateTarget.kind ='state' AND stateTarget.belong_to = regionTarget.id AND regionTarget.kind ='region' AND regionTarget.belong_to = countryTarget.id AND countryTarget.kind ='country' UNION ALL SELECT countrySource.acronym oname, countrySource.latitude oy, countrySource.longitude ox, countryTarget.acronym dname, countryTarget.latitude dy, countryTarget.longitude dx FROM  public.edge edge , public.place instituitionSource, public.place citySource, public.place countrySource , public.place instituitionTarget, public.place cityTarget, public.place countryTarget WHERE edge.kind='doutorado' AND edge.end_year = 1973 AND edge.kind != 'work'  AND  edge.source = instituitionSource.id AND instituitionSource.kind ='instituition' AND instituitionSource.belong_to = citySource.id AND citySource.kind ='city' AND citySource.belong_to = countrySource.id AND countrySource.kind ='country'  AND  edge.target = instituitionTarget.id AND instituitionTarget.kind ='instituition' AND instituitionTarget.belong_to = cityTarget.id AND cityTarget.kind ='city' AND cityTarget.belong_to = countryTarget.id AND countryTarget.kind ='country') flow GROUP BY oy, ox, oname, dx, dy, dname ORDER BY oname, dname
>>>> 10/07/2015 01:12:49
c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25)
 >>>> 10/07/2015 01:12:49
c("argentina", "argentina", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "canada", "chile", "chile", "cuba", "france", "france", "germany", "italy", "italy", "netherlands", "spain", "united kingdom", "united kingdom", "united states", "united states")
 >>>> 10/07/2015 01:12:49
c(-38.416097, -38.416097, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, 56.130366, -35.675147, -35.675147, 21.521757, 46.227638, 46.227638, 51.165691, 41.87194, 41.87194, 52.132633, 40.463667, 55.378051, 55.378051, 37.09024, 37.09024)
 >>>> 10/07/2015 01:12:49
c(-63.616672, -63.616672, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -106.346771, -71.542969, -71.542969, -77.781167, 2.213749, 2.213749, 10.451526, 12.56738, 12.56738, 5.291266, -3.74922, -3.435973, -3.435973, -95.712891, -95.712891)
 >>>> 10/07/2015 01:12:49
c("argentina", "united states", "belgium", "brazil", "canada", "france", "germany", "italy", "united kingdom", "united states", "canada", "brazil", "france", "united kingdom", "brazil", "france", "germany", "france", "italy", "netherlands", "spain", "united kingdom", "united states", "brazil", "united states")
 >>>> 10/07/2015 01:12:49
c(-38.416097, 37.09024, 50.503887, -14.235004, 56.130366, 46.227638, 51.165691, 41.87194, 55.378051, 37.09024, 56.130366, -14.235004, 46.227638, 55.378051, -14.235004, 46.227638, 51.165691, 46.227638, 41.87194, 52.132633, 40.463667, 55.378051, 37.09024, -14.235004, 37.09024)
 >>>> 10/07/2015 01:12:49
c(-63.616672, -95.712891, 4.469936, -51.92528, -106.346771, 2.213749, 10.451526, 12.56738, -3.435973, -95.712891, -106.346771, -51.92528, 2.213749, -3.435973, -51.92528, 2.213749, 10.451526, 2.213749, 12.56738, 5.291266, -3.74922, -3.435973, -95.712891, -51.92528, -95.712891)
 >>>> 10/07/2015 01:12:49
c(1, 2, 1, 328, 1, 10, 1, 1, 1, 25, 3, 1, 1, 1, 2, 4, 1, 1, 2, 2, 3, 3, 1, 14, 20)
[1] "fff-country-rangeYear"
[1] "year 1983"
>>>> 10/07/2015 01:12:51
SELECT row_number() OVER () as id, oname, oy, ox, dname, dy, dx, count(*) trips FROM (SELECT countrySource.acronym oname, countrySource.latitude oy, countrySource.longitude ox, countryTarget.acronym dname, countryTarget.latitude dy, countryTarget.longitude dx FROM  public.edge edge , public.place instituitionSource, public.place citySource, public.place stateSource, public.place regionSource, public.place countrySource , public.place instituitionTarget, public.place cityTarget, public.place stateTarget, public.place regionTarget, public.place countryTarget WHERE edge.kind='doutorado' AND edge.end_year = 1983 AND edge.kind != 'work'  AND  edge.source = instituitionSource.id AND instituitionSource.kind ='instituition' AND instituitionSource.belong_to = citySource.id AND citySource.kind ='city' AND citySource.belong_to = stateSource.id AND stateSource.kind ='state' AND stateSource.belong_to = regionSource.id AND regionSource.kind ='region' AND regionSource.belong_to = countrySource.id AND countrySource.kind ='country'  AND  edge.target = instituitionTarget.id AND instituitionTarget.kind ='instituition' AND instituitionTarget.belong_to = cityTarget.id AND cityTarget.kind ='city' AND cityTarget.belong_to = stateTarget.id AND stateTarget.kind ='state' AND stateTarget.belong_to = regionTarget.id AND regionTarget.kind ='region' AND regionTarget.belong_to = countryTarget.id AND countryTarget.kind ='country' UNION ALL SELECT countrySource.acronym oname, countrySource.latitude oy, countrySource.longitude ox, countryTarget.acronym dname, countryTarget.latitude dy, countryTarget.longitude dx FROM  public.edge edge , public.place instituitionSource, public.place citySource, public.place stateSource, public.place regionSource, public.place countrySource , public.place instituitionTarget, public.place cityTarget, public.place countryTarget WHERE edge.kind='doutorado' AND edge.end_year = 1983 AND edge.kind != 'work'  AND  edge.source = instituitionSource.id AND instituitionSource.kind ='instituition' AND instituitionSource.belong_to = citySource.id AND citySource.kind ='city' AND citySource.belong_to = stateSource.id AND stateSource.kind ='state' AND stateSource.belong_to = regionSource.id AND regionSource.kind ='region' AND regionSource.belong_to = countrySource.id AND countrySource.kind ='country'  AND  edge.target = instituitionTarget.id AND instituitionTarget.kind ='instituition' AND instituitionTarget.belong_to = cityTarget.id AND cityTarget.kind ='city' AND cityTarget.belong_to = countryTarget.id AND countryTarget.kind ='country' UNION ALL SELECT countrySource.acronym oname, countrySource.latitude oy, countrySource.longitude ox, countryTarget.acronym dname, countryTarget.latitude dy, countryTarget.longitude dx FROM  public.edge edge , public.place instituitionSource, public.place citySource, public.place countrySource , public.place instituitionTarget, public.place cityTarget, public.place stateTarget, public.place regionTarget, public.place countryTarget WHERE edge.kind='doutorado' AND edge.end_year = 1983 AND edge.kind != 'work'  AND  edge.source = instituitionSource.id AND instituitionSource.kind ='instituition' AND instituitionSource.belong_to = citySource.id AND citySource.kind ='city' AND citySource.belong_to = countrySource.id AND countrySource.kind ='country'  AND  edge.target = instituitionTarget.id AND instituitionTarget.kind ='instituition' AND instituitionTarget.belong_to = cityTarget.id AND cityTarget.kind ='city' AND cityTarget.belong_to = stateTarget.id AND stateTarget.kind ='state' AND stateTarget.belong_to = regionTarget.id AND regionTarget.kind ='region' AND regionTarget.belong_to = countryTarget.id AND countryTarget.kind ='country' UNION ALL SELECT countrySource.acronym oname, countrySource.latitude oy, countrySource.longitude ox, countryTarget.acronym dname, countryTarget.latitude dy, countryTarget.longitude dx FROM  public.edge edge , public.place instituitionSource, public.place citySource, public.place countrySource , public.place instituitionTarget, public.place cityTarget, public.place countryTarget WHERE edge.kind='doutorado' AND edge.end_year = 1983 AND edge.kind != 'work'  AND  edge.source = instituitionSource.id AND instituitionSource.kind ='instituition' AND instituitionSource.belong_to = citySource.id AND citySource.kind ='city' AND citySource.belong_to = countrySource.id AND countrySource.kind ='country'  AND  edge.target = instituitionTarget.id AND instituitionTarget.kind ='instituition' AND instituitionTarget.belong_to = cityTarget.id AND cityTarget.kind ='city' AND cityTarget.belong_to = countryTarget.id AND countryTarget.kind ='country') flow GROUP BY oy, ox, oname, dx, dy, dname ORDER BY oname, dname
>>>> 10/07/2015 01:12:51
c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26)
 >>>> 10/07/2015 01:12:51
c("argentina", "argentina", "belgium", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "canada", "chile", "cuba", "france", "france", "germany", "germany", "italy", "spain", "united kingdom", "united kingdom", "united states", "united states", "united states", "united states")
 >>>> 10/07/2015 01:12:51
c(-38.416097, -38.416097, 50.503887, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, 56.130366, -35.675147, 21.521757, 46.227638, 46.227638, 51.165691, 51.165691, 41.87194, 40.463667, 55.378051, 55.378051, 37.09024, 37.09024, 37.09024, 37.09024)
 >>>> 10/07/2015 01:12:51
c(-63.616672, -63.616672, 4.469936, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -106.346771, -71.542969, -77.781167, 2.213749, 2.213749, 10.451526, 10.451526, 12.56738, -3.74922, -3.435973, -3.435973, -95.712891, -95.712891, -95.712891, -95.712891)
 >>>> 10/07/2015 01:12:51
c("brazil", "spain", "belgium", "belgium", "brazil", "canada", "france", "germany", "spain", "united kingdom", "united states", "canada", "brazil", "cuba", "brazil", "france", "germany", "united states", "italy", "spain", "brazil", "united kingdom", "brazil", "spain", "united kingdom", "united states")
 >>>> 10/07/2015 01:12:51
c(-14.235004, 40.463667, 50.503887, 50.503887, -14.235004, 56.130366, 46.227638, 51.165691, 40.463667, 55.378051, 37.09024, 56.130366, -14.235004, 21.521757, -14.235004, 46.227638, 51.165691, 37.09024, 41.87194, 40.463667, -14.235004, 55.378051, -14.235004, 40.463667, 55.378051, 37.09024)
 >>>> 10/07/2015 01:12:51
c(-51.92528, -3.74922, 4.469936, 4.469936, -51.92528, -106.346771, 2.213749, 10.451526, -3.74922, -3.435973, -95.712891, -106.346771, -51.92528, -77.781167, -51.92528, 2.213749, 10.451526, -95.712891, 12.56738, -3.74922, -51.92528, -3.435973, -51.92528, -3.74922, -3.435973, -95.712891)
 >>>> 10/07/2015 01:12:51
c(2, 1, 2, 1, 399, 3, 27, 5, 1, 44, 68, 3, 1, 1, 3, 17, 8, 1, 3, 3, 1, 3, 10, 1, 4, 39)
[1] "fff-country-rangeYear"
[1] "year 1993"
>>>> 10/07/2015 01:12:54
SELECT row_number() OVER () as id, oname, oy, ox, dname, dy, dx, count(*) trips FROM (SELECT countrySource.acronym oname, countrySource.latitude oy, countrySource.longitude ox, countryTarget.acronym dname, countryTarget.latitude dy, countryTarget.longitude dx FROM  public.edge edge , public.place instituitionSource, public.place citySource, public.place stateSource, public.place regionSource, public.place countrySource , public.place instituitionTarget, public.place cityTarget, public.place stateTarget, public.place regionTarget, public.place countryTarget WHERE edge.kind='doutorado' AND edge.end_year = 1993 AND edge.kind != 'work'  AND  edge.source = instituitionSource.id AND instituitionSource.kind ='instituition' AND instituitionSource.belong_to = citySource.id AND citySource.kind ='city' AND citySource.belong_to = stateSource.id AND stateSource.kind ='state' AND stateSource.belong_to = regionSource.id AND regionSource.kind ='region' AND regionSource.belong_to = countrySource.id AND countrySource.kind ='country'  AND  edge.target = instituitionTarget.id AND instituitionTarget.kind ='instituition' AND instituitionTarget.belong_to = cityTarget.id AND cityTarget.kind ='city' AND cityTarget.belong_to = stateTarget.id AND stateTarget.kind ='state' AND stateTarget.belong_to = regionTarget.id AND regionTarget.kind ='region' AND regionTarget.belong_to = countryTarget.id AND countryTarget.kind ='country' UNION ALL SELECT countrySource.acronym oname, countrySource.latitude oy, countrySource.longitude ox, countryTarget.acronym dname, countryTarget.latitude dy, countryTarget.longitude dx FROM  public.edge edge , public.place instituitionSource, public.place citySource, public.place stateSource, public.place regionSource, public.place countrySource , public.place instituitionTarget, public.place cityTarget, public.place countryTarget WHERE edge.kind='doutorado' AND edge.end_year = 1993 AND edge.kind != 'work'  AND  edge.source = instituitionSource.id AND instituitionSource.kind ='instituition' AND instituitionSource.belong_to = citySource.id AND citySource.kind ='city' AND citySource.belong_to = stateSource.id AND stateSource.kind ='state' AND stateSource.belong_to = regionSource.id AND regionSource.kind ='region' AND regionSource.belong_to = countrySource.id AND countrySource.kind ='country'  AND  edge.target = instituitionTarget.id AND instituitionTarget.kind ='instituition' AND instituitionTarget.belong_to = cityTarget.id AND cityTarget.kind ='city' AND cityTarget.belong_to = countryTarget.id AND countryTarget.kind ='country' UNION ALL SELECT countrySource.acronym oname, countrySource.latitude oy, countrySource.longitude ox, countryTarget.acronym dname, countryTarget.latitude dy, countryTarget.longitude dx FROM  public.edge edge , public.place instituitionSource, public.place citySource, public.place countrySource , public.place instituitionTarget, public.place cityTarget, public.place stateTarget, public.place regionTarget, public.place countryTarget WHERE edge.kind='doutorado' AND edge.end_year = 1993 AND edge.kind != 'work'  AND  edge.source = instituitionSource.id AND instituitionSource.kind ='instituition' AND instituitionSource.belong_to = citySource.id AND citySource.kind ='city' AND citySource.belong_to = countrySource.id AND countrySource.kind ='country'  AND  edge.target = instituitionTarget.id AND instituitionTarget.kind ='instituition' AND instituitionTarget.belong_to = cityTarget.id AND cityTarget.kind ='city' AND cityTarget.belong_to = stateTarget.id AND stateTarget.kind ='state' AND stateTarget.belong_to = regionTarget.id AND regionTarget.kind ='region' AND regionTarget.belong_to = countryTarget.id AND countryTarget.kind ='country' UNION ALL SELECT countrySource.acronym oname, countrySource.latitude oy, countrySource.longitude ox, countryTarget.acronym dname, countryTarget.latitude dy, countryTarget.longitude dx FROM  public.edge edge , public.place instituitionSource, public.place citySource, public.place countrySource , public.place instituitionTarget, public.place cityTarget, public.place countryTarget WHERE edge.kind='doutorado' AND edge.end_year = 1993 AND edge.kind != 'work'  AND  edge.source = instituitionSource.id AND instituitionSource.kind ='instituition' AND instituitionSource.belong_to = citySource.id AND citySource.kind ='city' AND citySource.belong_to = countrySource.id AND countrySource.kind ='country'  AND  edge.target = instituitionTarget.id AND instituitionTarget.kind ='instituition' AND instituitionTarget.belong_to = cityTarget.id AND cityTarget.kind ='city' AND cityTarget.belong_to = countryTarget.id AND countryTarget.kind ='country') flow GROUP BY oy, ox, oname, dx, dy, dname ORDER BY oname, dname
>>>> 10/07/2015 01:17:09
c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42)
 >>>> 10/07/2015 01:17:09
c("argentina", "argentina", "argentina", "argentina", "belgium", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "canada", "canada", "chile", "chile", "colombia", "cuba", "france", "france", "france", "france", "germany", "italy", "italy", "netherlands", "peru", "portugal", "portugal", "spain", "sweden", "united kingdom", "united kingdom", "united kingdom", "united states", "united states", "united states", "uruguay")
 >>>> 10/07/2015 01:17:09
c(-38.416097, -38.416097, -38.416097, -38.416097, 50.503887, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, 56.130366, 56.130366, -35.675147, -35.675147, 4.570868, 21.521757, 46.227638, 46.227638, 46.227638, 46.227638, 51.165691, 41.87194, 41.87194, 52.132633, -9.189967, 39.399872, 39.399872, 40.463667, 60.128161, 55.378051, 55.378051, 55.378051, 37.09024, 37.09024, 37.09024, -32.522779)
 >>>> 10/07/2015 01:17:09
c(-63.616672, -63.616672, -63.616672, -63.616672, 4.469936, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -106.346771, -106.346771, -71.542969, -71.542969, -74.297333, -77.781167, 2.213749, 2.213749, 2.213749, 2.213749, 10.451526, 12.56738, 12.56738, 5.291266, -75.015152, -8.224454, -8.224454, -3.74922, 18.643501, -3.435973, -3.435973, -3.435973, -95.712891, -95.712891, -95.712891, -55.765835)
 >>>> 10/07/2015 01:17:09
c("argentina", "brazil", "spain", "united states", "belgium", "argentina", "belgium", "brazil", "canada", "france", "germany", "italy", "portugal", "spain", "united kingdom", "united states", "canada", "united kingdom", "brazil", "spain", "brazil", "cuba", "belgium", "brazil", "france", "united states", "germany", "brazil", "italy", "netherlands", "brazil", "portugal", "united kingdom", "spain", "sweden", "brazil", "united kingdom", "united states", "brazil", "united kingdom", "united states", "united kingdom"
)
 >>>> 10/07/2015 01:17:09
c(-38.416097, -14.235004, 40.463667, 37.09024, 50.503887, -38.416097, 50.503887, -14.235004, 56.130366, 46.227638, 51.165691, 41.87194, 39.399872, 40.463667, 55.378051, 37.09024, 56.130366, 55.378051, -14.235004, 40.463667, -14.235004, 21.521757, 50.503887, -14.235004, 46.227638, 37.09024, 51.165691, -14.235004, 41.87194, 52.132633, -14.235004, 39.399872, 55.378051, 40.463667, 60.128161, -14.235004, 55.378051, 37.09024, -14.235004, 55.378051, 37.09024, 55.378051)
 >>>> 10/07/2015 01:17:09
c(-63.616672, -51.92528, -3.74922, -95.712891, 4.469936, -63.616672, 4.469936, -51.92528, -106.346771, 2.213749, 10.451526, 12.56738, -8.224454, -3.74922, -3.435973, -95.712891, -106.346771, -3.435973, -51.92528, -3.74922, -51.92528, -77.781167, 4.469936, -51.92528, 2.213749, -95.712891, 10.451526, -51.92528, 12.56738, 5.291266, -51.92528, -8.224454, -3.435973, -3.74922, 18.643501, -51.92528, -3.435973, -95.712891, -51.92528, -3.435973, -95.712891, -3.435973)
 >>>> 10/07/2015 01:17:09
c(6, 3, 1, 1, 1, 2, 1, 1400, 14, 59, 25, 7, 7, 25, 89, 87, 2, 1, 1, 1, 1, 2, 1, 6, 26, 1, 8, 1, 3, 1, 1, 5, 3, 7, 1, 4, 15, 1, 10, 2, 36, 1)
[1] "fff-country-rangeYear"
[1] "year 2003"
>>>> 10/07/2015 01:17:13
SELECT row_number() OVER () as id, oname, oy, ox, dname, dy, dx, count(*) trips FROM (SELECT countrySource.acronym oname, countrySource.latitude oy, countrySource.longitude ox, countryTarget.acronym dname, countryTarget.latitude dy, countryTarget.longitude dx FROM  public.edge edge , public.place instituitionSource, public.place citySource, public.place stateSource, public.place regionSource, public.place countrySource , public.place instituitionTarget, public.place cityTarget, public.place stateTarget, public.place regionTarget, public.place countryTarget WHERE edge.kind='doutorado' AND edge.end_year = 2003 AND edge.kind != 'work'  AND  edge.source = instituitionSource.id AND instituitionSource.kind ='instituition' AND instituitionSource.belong_to = citySource.id AND citySource.kind ='city' AND citySource.belong_to = stateSource.id AND stateSource.kind ='state' AND stateSource.belong_to = regionSource.id AND regionSource.kind ='region' AND regionSource.belong_to = countrySource.id AND countrySource.kind ='country'  AND  edge.target = instituitionTarget.id AND instituitionTarget.kind ='instituition' AND instituitionTarget.belong_to = cityTarget.id AND cityTarget.kind ='city' AND cityTarget.belong_to = stateTarget.id AND stateTarget.kind ='state' AND stateTarget.belong_to = regionTarget.id AND regionTarget.kind ='region' AND regionTarget.belong_to = countryTarget.id AND countryTarget.kind ='country' UNION ALL SELECT countrySource.acronym oname, countrySource.latitude oy, countrySource.longitude ox, countryTarget.acronym dname, countryTarget.latitude dy, countryTarget.longitude dx FROM  public.edge edge , public.place instituitionSource, public.place citySource, public.place stateSource, public.place regionSource, public.place countrySource , public.place instituitionTarget, public.place cityTarget, public.place countryTarget WHERE edge.kind='doutorado' AND edge.end_year = 2003 AND edge.kind != 'work'  AND  edge.source = instituitionSource.id AND instituitionSource.kind ='instituition' AND instituitionSource.belong_to = citySource.id AND citySource.kind ='city' AND citySource.belong_to = stateSource.id AND stateSource.kind ='state' AND stateSource.belong_to = regionSource.id AND regionSource.kind ='region' AND regionSource.belong_to = countrySource.id AND countrySource.kind ='country'  AND  edge.target = instituitionTarget.id AND instituitionTarget.kind ='instituition' AND instituitionTarget.belong_to = cityTarget.id AND cityTarget.kind ='city' AND cityTarget.belong_to = countryTarget.id AND countryTarget.kind ='country' UNION ALL SELECT countrySource.acronym oname, countrySource.latitude oy, countrySource.longitude ox, countryTarget.acronym dname, countryTarget.latitude dy, countryTarget.longitude dx FROM  public.edge edge , public.place instituitionSource, public.place citySource, public.place countrySource , public.place instituitionTarget, public.place cityTarget, public.place stateTarget, public.place regionTarget, public.place countryTarget WHERE edge.kind='doutorado' AND edge.end_year = 2003 AND edge.kind != 'work'  AND  edge.source = instituitionSource.id AND instituitionSource.kind ='instituition' AND instituitionSource.belong_to = citySource.id AND citySource.kind ='city' AND citySource.belong_to = countrySource.id AND countrySource.kind ='country'  AND  edge.target = instituitionTarget.id AND instituitionTarget.kind ='instituition' AND instituitionTarget.belong_to = cityTarget.id AND cityTarget.kind ='city' AND cityTarget.belong_to = stateTarget.id AND stateTarget.kind ='state' AND stateTarget.belong_to = regionTarget.id AND regionTarget.kind ='region' AND regionTarget.belong_to = countryTarget.id AND countryTarget.kind ='country' UNION ALL SELECT countrySource.acronym oname, countrySource.latitude oy, countrySource.longitude ox, countryTarget.acronym dname, countryTarget.latitude dy, countryTarget.longitude dx FROM  public.edge edge , public.place instituitionSource, public.place citySource, public.place countrySource , public.place instituitionTarget, public.place cityTarget, public.place countryTarget WHERE edge.kind='doutorado' AND edge.end_year = 2003 AND edge.kind != 'work'  AND  edge.source = instituitionSource.id AND instituitionSource.kind ='instituition' AND instituitionSource.belong_to = citySource.id AND citySource.kind ='city' AND citySource.belong_to = countrySource.id AND countrySource.kind ='country'  AND  edge.target = instituitionTarget.id AND instituitionTarget.kind ='instituition' AND instituitionTarget.belong_to = cityTarget.id AND cityTarget.kind ='city' AND cityTarget.belong_to = countryTarget.id AND countryTarget.kind ='country') flow GROUP BY oy, ox, oname, dx, dy, dname ORDER BY oname, dname
>>>> 10/07/2015 01:23:52
c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61)
 >>>> 10/07/2015 01:23:52
c("argentina", "argentina", "belgium", "belgium", "belgium", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "canada", "chile", "colombia", "colombia", "colombia", "cuba", "cuba", "cuba", "france", "france", "france", "germany", "germany", "germany", "italy", "italy", "italy", "japan", "japan", "peru", "portugal", "portugal", "portugal", "spain", "spain", "spain", "sweden", 
"united kingdom", "united kingdom", "united kingdom", "united states", "united states", "united states", "united states", "uruguay", "uruguay", "venezuela", "venezuela")
 >>>> 10/07/2015 01:23:52
c(-38.416097, -38.416097, 50.503887, 50.503887, 50.503887, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, -14.235004, 56.130366, -35.675147, 4.570868, 4.570868, 4.570868, 21.521757, 21.521757, 21.521757, 46.227638, 46.227638, 46.227638, 51.165691, 51.165691, 51.165691, 41.87194, 41.87194, 41.87194, 36.204824, 36.204824, -9.189967, 39.399872, 
39.399872, 39.399872, 40.463667, 40.463667, 40.463667, 60.128161, 55.378051, 55.378051, 55.378051, 37.09024, 37.09024, 37.09024, 37.09024, -32.522779, -32.522779, 6.42375, 6.42375)
 >>>> 10/07/2015 01:23:52
c(-63.616672, -63.616672, 4.469936, 4.469936, 4.469936, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -51.92528, -106.346771, -71.542969, -74.297333, -74.297333, -74.297333, -77.781167, -77.781167, -77.781167, 2.213749, 2.213749, 2.213749, 10.451526, 10.451526, 10.451526, 12.56738, 12.56738, 12.56738, 138.252924, 138.252924, -75.015152, -8.224454, -8.224454, 
-8.224454, -3.74922, -3.74922, -3.74922, 18.643501, -3.435973, -3.435973, -3.435973, -95.712891, -95.712891, -95.712891, -95.712891, -55.765835, -55.765835, -66.58973, -66.58973)
 >>>> 10/07/2015 01:23:52
c("argentina", "brazil", "belgium", "brazil", "france", "argentina", "australia", "belgium", "brazil", "canada", "chile", "cuba", "france", "germany", "italy", "japan", "netherlands", "portugal", "spain", "switzerland", "united kingdom", "united states", "venezuela", "brazil", "brazil", "brazil", "colombia", "united states", "brazil", "cuba", "spain", "brazil", "france", "united kingdom", "brazil", "germany", "sweden", "brazil", "italy", "spain", "germany", "japan", "brazil", "brazil", "portugal", 
"united kingdom", "brazil", "germany", "spain", "sweden", "brazil", "spain", "united kingdom", "brazil", "canada", "united kingdom", "united states", "brazil", "united states", "spain", "venezuela")
 >>>> 10/07/2015 01:23:52
c(-38.416097, -14.235004, 50.503887, -14.235004, 46.227638, -38.416097, -25.274398, 50.503887, -14.235004, 56.130366, -35.675147, 21.521757, 46.227638, 51.165691, 41.87194, 36.204824, 52.132633, 39.399872, 40.463667, 46.818188, 55.378051, 37.09024, 6.42375, -14.235004, -14.235004, -14.235004, 4.570868, 37.09024, -14.235004, 21.521757, 40.463667, -14.235004, 46.227638, 55.378051, -14.235004, 51.165691, 60.128161, -14.235004, 41.87194, 40.463667, 51.165691, 36.204824, -14.235004, -14.235004, 39.399872, 
55.378051, -14.235004, 51.165691, 40.463667, 60.128161, -14.235004, 40.463667, 55.378051, -14.235004, 56.130366, 55.378051, 37.09024, -14.235004, 37.09024, 40.463667, 6.42375)
 >>>> 10/07/2015 01:23:52
c(-63.616672, -51.92528, 4.469936, -51.92528, 2.213749, -63.616672, 133.775136, 4.469936, -51.92528, -106.346771, -71.542969, -77.781167, 2.213749, 10.451526, 12.56738, 138.252924, 5.291266, -8.224454, -3.74922, 8.227512, -3.435973, -95.712891, -66.58973, -51.92528, -51.92528, -51.92528, -74.297333, -95.712891, -51.92528, -77.781167, -3.74922, -51.92528, 2.213749, -3.435973, -51.92528, 10.451526, 18.643501, -51.92528, 12.56738, -3.74922, 10.451526, 138.252924, -51.92528, -51.92528, -8.224454, -3.435973, 
-51.92528, 10.451526, -3.74922, 18.643501, -51.92528, -3.74922, -3.435973, -51.92528, -106.346771, -3.435973, -95.712891, -51.92528, -95.712891, -3.74922, -66.58973)
 >>>> 10/07/2015 01:23:52
c(4, 1, 1, 2, 1, 4, 5, 3, 7210, 6, 1, 1, 35, 10, 4, 2, 2, 24, 74, 1, 28, 75, 1, 4, 1, 3, 3, 1, 4, 3, 1, 9, 17, 1, 4, 9, 1, 4, 11, 1, 1, 1, 6, 3, 15, 1, 4, 1, 21, 1, 18, 1, 12, 38, 1, 1, 41, 1, 1, 1, 1)
[1] "fff-country-rangeYear"
[1] "year 2013"
>>>> 10/07/2015 01:23:55
SELECT row_number() OVER () as id, oname, oy, ox, dname, dy, dx, count(*) trips FROM (SELECT countrySource.acronym oname, countrySource.latitude oy, countrySource.longitude ox, countryTarget.acronym dname, countryTarget.latitude dy, countryTarget.longitude dx FROM  public.edge edge , public.place instituitionSource, public.place citySource, public.place stateSource, public.place regionSource, public.place countrySource , public.place instituitionTarget, public.place cityTarget, public.place stateTarget, public.place regionTarget, public.place countryTarget WHERE edge.kind='doutorado' AND edge.end_year = 2013 AND edge.kind != 'work'  AND  edge.source = instituitionSource.id AND instituitionSource.kind ='instituition' AND instituitionSource.belong_to = citySource.id AND citySource.kind ='city' AND citySource.belong_to = stateSource.id AND stateSource.kind ='state' AND stateSource.belong_to = regionSource.id AND regionSource.kind ='region' AND regionSource.belong_to = countrySource.id AND countrySource.kind ='country'  AND  edge.target = instituitionTarget.id AND instituitionTarget.kind ='instituition' AND instituitionTarget.belong_to = cityTarget.id AND cityTarget.kind ='city' AND cityTarget.belong_to = stateTarget.id AND stateTarget.kind ='state' AND stateTarget.belong_to = regionTarget.id AND regionTarget.kind ='region' AND regionTarget.belong_to = countryTarget.id AND countryTarget.kind ='country' UNION ALL SELECT countrySource.acronym oname, countrySource.latitude oy, countrySource.longitude ox, countryTarget.acronym dname, countryTarget.latitude dy, countryTarget.longitude dx FROM  public.edge edge , public.place instituitionSource, public.place citySource, public.place stateSource, public.place regionSource, public.place countrySource , public.place instituitionTarget, public.place cityTarget, public.place countryTarget WHERE edge.kind='doutorado' AND edge.end_year = 2013 AND edge.kind != 'work'  AND  edge.source = instituitionSource.id AND instituitionSource.kind ='instituition' AND instituitionSource.belong_to = citySource.id AND citySource.kind ='city' AND citySource.belong_to = stateSource.id AND stateSource.kind ='state' AND stateSource.belong_to = regionSource.id AND regionSource.kind ='region' AND regionSource.belong_to = countrySource.id AND countrySource.kind ='country'  AND  edge.target = instituitionTarget.id AND instituitionTarget.kind ='instituition' AND instituitionTarget.belong_to = cityTarget.id AND cityTarget.kind ='city' AND cityTarget.belong_to = countryTarget.id AND countryTarget.kind ='country' UNION ALL SELECT countrySource.acronym oname, countrySource.latitude oy, countrySource.longitude ox, countryTarget.acronym dname, countryTarget.latitude dy, countryTarget.longitude dx FROM  public.edge edge , public.place instituitionSource, public.place citySource, public.place countrySource , public.place instituitionTarget, public.place cityTarget, public.place stateTarget, public.place regionTarget, public.place countryTarget WHERE edge.kind='doutorado' AND edge.end_year = 2013 AND edge.kind != 'work'  AND  edge.source = instituitionSource.id AND instituitionSource.kind ='instituition' AND instituitionSource.belong_to = citySource.id AND citySource.kind ='city' AND citySource.belong_to = countrySource.id AND countrySource.kind ='country'  AND  edge.target = instituitionTarget.id AND instituitionTarget.kind ='instituition' AND instituitionTarget.belong_to = cityTarget.id AND cityTarget.kind ='city' AND cityTarget.belong_to = stateTarget.id AND stateTarget.kind ='state' AND stateTarget.belong_to = regionTarget.id AND regionTarget.kind ='region' AND regionTarget.belong_to = countryTarget.id AND countryTarget.kind ='country' UNION ALL SELECT countrySource.acronym oname, countrySource.latitude oy, countrySource.longitude ox, countryTarget.acronym dname, countryTarget.latitude dy, countryTarget.longitude dx FROM  public.edge edge , public.place instituitionSource, public.place citySource, public.place countrySource , public.place instituitionTarget, public.place cityTarget, public.place countryTarget WHERE edge.kind='doutorado' AND edge.end_year = 2013 AND edge.kind != 'work'  AND  edge.source = instituitionSource.id AND instituitionSource.kind ='instituition' AND instituitionSource.belong_to = citySource.id AND citySource.kind ='city' AND citySource.belong_to = countrySource.id AND countrySource.kind ='country'  AND  edge.target = instituitionTarget.id AND instituitionTarget.kind ='instituition' AND instituitionTarget.belong_to = cityTarget.id AND cityTarget.kind ='city' AND cityTarget.belong_to = countryTarget.id AND countryTarget.kind ='country') flow GROUP BY oy, ox, oname, dx, dy, dname ORDER BY oname, dname
